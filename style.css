body {
    font-family: Arial;
    text-align: center;
    background: #eef;
}

button {
    padding: 10px;
    margin: 5px;
    font-size: 16px;
}

.hidden {
    display: none;
}

.game {
    margin-top: 20px;
}

/* Tic Tac Toe */
#ttt-board {
    display: grid;
    grid-template-columns: repeat(3, 80px);
    gap: 5px;
    justify-content: center;
}

.cell {
    width: 80px;
    height: 80px;
    border: 2px solid black;
    font-size: 40px;
    background: white;
    cursor: pointer;
}

// ================== CHESS GAME ==================

// Initial board setup
const startBoard = [
  ["r","n","b","q","k","b","n","r"],
  ["p","p","p","p","p","p","p","p"],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["","","","","","","",""],
  ["P","P","P","P","P","P","P","P"],
  ["R","N","B","Q","K","B","N","R"]
];

let board = JSON.parse(JSON.stringify(startBoard));
let selectedSquare = null;

// Draw chess board
function drawChessBoard() {
  const boardDiv = document.getElementById("chess-board");
  boardDiv.innerHTML = "";

  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      const cell = document.createElement("div");
      cell.className = "chess-cell " + ((r + c) % 2 ? "chess-black" : "chess-white");
      cell.textContent = board[r][c];
      cell.onclick = () => handleClick(r, c);
      boardDiv.appendChild(cell);
    }
  }
}

// Handle player move
function handleClick(r, c) {
  const piece = board[r][c];

  if (selectedSquare) {
    const [sr, sc] = selectedSquare;
    const movingPiece = board[sr][sc];

    if (movingPiece === movingPiece.toUpperCase()) {
      board[r][c] = movingPiece;
      board[sr][sc] = "";
      selectedSquare = null;
      drawChessBoard();
      setTimeout(chessAI, 400);
    }
  } else if (piece && piece === piece.toUpperCase()) {
    selectedSquare = [r, c];
  }
}

// AI move (smart but beatable)
function chessAI() {
  let moves = [];

  for (let r = 0; r < 8; r++) {
    for (let c = 0; c < 8; c++) {
      let piece = board[r][c];

      if (piece && piece === piece.toLowerCase()) {
        let dirs = [[1,0],[-1,0],[0,1],[0,-1]];

        dirs.forEach(d => {
          let nr = r + d[0];
          let nc = c + d[1];

          if (nr >= 0 && nr < 8 && nc >= 0 && nc < 8) {
            let target = board[nr][nc];
            let score = 0;

            if (target && target === target.toUpperCase()) score += 5;
            if (piece === "p" && nr > r) score += 2;
            if ([3,4].includes(nr) && [3,4].includes(nc)) score += 1;

            if (!target || target === target.toUpperCase()) {
              moves.push({
                from: [r, c],
                to: [nr, nc],
                score: score
              });
            }
          }
        });
      }
    }
  }

  if (moves.length === 0) return;

  moves.sort((a, b) => b.score - a.score);
  let best = moves.slice(0, 3);
  let move = best[Math.floor(Math.random() * best.length)];

  board[move.to[0]][move.to[1]] = board[move.from[0]][move.from[1]];
  board[move.from[0]][move.from[1]] = "";

  drawChessBoard();
}

// Start game
drawChessBoard();
